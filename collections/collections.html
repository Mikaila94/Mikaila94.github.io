<div sticky-scroll id="toolbar" class="container-fluid div-card" style="width: 960px; margin-bottom: 10px">
    <div class="row" style="margin-top: 5px; margin-bottom: 5px">
        <div class="col-xs-6">
         <span class="glyphicon glyphicon-chevron-left" style="cursor:pointer;margin-top: 7px" align="left"
               ng-click="goTo('/subjects')">Forsiden</span>
        </div>
        <div class="col-xs-6" align="right">
            <label class="btn btn-default" ng-click="saveSubject()">
                <span class="glyphicon glyphicon-floppy-disk"></span>
            </label>
        </div>
    </div>
</div>
<div ng-show="showStickyToolbar" id="stickyToolbar" class="container-fluid div-sticky-toolbar" align="center">
    <div class="row" style="width: 960px; margin-top: 5px; margin-bottom: 5px">
        <div class="col-xs-6" align="left">
         <span class="glyphicon glyphicon-chevron-left" style="cursor:pointer; margin-top: 7px"
               ng-click="goTo('/subjects')">Forsiden</span>
        </div>
        <div class="col-xs-6" align="right">
            <label class="btn btn-default" ng-click="saveSubject()">
                <span class="glyphicon glyphicon-floppy-disk"></span>
            </label>
        </div>
    </div>
</div>

<div class="container-fluid">
    <div class="container-fluid div-card" ng-mouseenter="showExtendButton = true" ng-mouseleave="showExtendButton = false" style="width:960px;margin-bottom: 20px; position: relative">
        <div class="container-fluid" style="margin-bottom: 5px; margin-top: 20px">
            <div class="col-xs-12">
                <span style="font-size: 25px; padding-right: 2px">{{nameCopy}}</span>
                <span>({{subject.code}})</span>
            </div>
            <div class="col-xs-12">
                {{subject.description}}
            </div>
        </div>

        <div ng-show="editSubjectInfo" class="container-fluid" align="left" style="margin-bottom: 20px">
            <hr>
            <div class="col-xs-6">
                <textarea msd-elastic ng-model="subject.name" rows="1" class="open-text-input" style="width:400px;" placeholder="Navn på pakke"></textarea>
            </div>
            <div class="col-xs-6">
                <textarea msd-elastic ng-model="subject.description" rows="1" class="open-text-input" style="width:400px;resize: none;" placeholder="Beskrivelse av faget"></textarea>
            </div>
        </div>
        <div class="container-fluid" align="center" style="height: 30px">
            <span ng-show="showExtendButton && !editSubjectInfo" ng-click="editSubjectInfo = true" class="glyphicon glyphicon-menu-down"
                  style="font-size: 20px; cursor: pointer"></span>
            <span ng-show="showExtendButton && editSubjectInfo" ng-click="editSubjectInfo = false" class="glyphicon glyphicon-menu-up"
                  style="font-size: 20px; cursor: pointer"></span>
        </div>


        <form style="position:absolute;top:10px;right:10px;">
            <button class="btn btn-default" ng-click="publishSubject()">Publiser</button>
        </form>

    </div>

    <div class="container-fluid div-card" style="width:960px; margin-bottom: 30px">
        <div class="container-fluid">
            <div class="col-xs-12">
                <h3>Oppgavesett</h3>
                <p ng-if="collections.length == 0">Her var det tomt, gitt. Kom i gang ved å lage et oppgavesett, eller enda bedre: kopier fra noen andre</p>
                <button class="btn btn-default" ng-click="setTargetCollection('new')" style="margin-bottom: 10px; margin-top: 10px;width:20%;">
                    <span class="glyphicon glyphicon-plus"></span>
                    Nytt oppgavesett
                </button>
                <button class="btn btn-default" ng-click="setTargetCollection('new')" style="margin-bottom: 10px; margin-top: 10px;width:20%;">
                    <span class="glyphicon glyphicon-arrow-right"></span>
                    Hent oppgavesett
                </button>

            </div>
        </div>

        <div id="collectionsArea">
            <div as-sortable="dragControlListeners" ng-model="collections">
                <div as-sortable-item ng-repeat="collection in collections track by $index" ng-model="collection"
                     ng-mouseenter="focused[$index] = true" ng-mouseleave="focused[$index] = false">
                    <div as-sortable-item-handle class="container-fluid">
                        <div class="col-xs-11">
                            <h4 ng-click="setTargetCollection($index)" style="cursor: pointer">{{collection.name}} ({{collection.exercises.length}} oppgaver)</h4>
                        </div>
                        <div class="col-xs-1">
                            <span ng-show="focused[$index]" ng-click="deleteCollection(collection,$index)" style="margin-top:10px;cursor: pointer" class="glyphicon glyphicon-trash"></span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="container-fluid" style="height: 30px"></div>


    </div>


    <div class="container-fluid div-card" style="width: 960px; margin-bottom: 20px" align="center">
        <h2 align="center">Høydepunkt</h2>
        <hr>
        <div class="container-fluid" align="left" style="margin-bottom: 20px">
            <div class="col-xs-7" style="border-right: thin solid #F1F1F2;">
                <div class="row" style="margin-bottom: 50px;">
                    <div class="col-xs-6">
                        <span class="glyphicon glyphicon-heart" style="font-size: 30px">3000</span>
                    </div>
                    <div class="col-xs-6">
                        <span class="glyphicon glyphicon-star" style="font-size: 30px">3123</span>
                    </div>
                </div>
                <div class="row">
                    <div class="col-xs-6">
                        <span class="glyphicon glyphicon-download" style="font-size: 30px">520</span>
                    </div>
                    <div class="col-xs-6">
                        <span class="glyphicon glyphicon-copyright-mark" style="font-size: 30px">1029</span>
                    </div>
                </div>
                <div class="container-fluid" style="height: 40px"></div>
            </div>
            <div class="col-xs-5">
                <label style="margin-top: 5px">Tilbakemeldinger:</label>
                <p>Siste tilbakemeldinger:</p>
                <ul>
                    <li ng-repeat="report in reportedExercises | orderBy: 'lastAdded':true | limitTo: 3">
                        <a style="cursor: pointer" ng-click="openReportModal(report.collectionId, report.exerciseId)">
                            {{report.lastAdded}}, {{reportedCollections[report.collectionId].name}}
                        </a>
                    </li>
                </ul>
                <div ng-if="reportedExercises.length > 0" class="container-fluid" style="width: 100%; margin-top: 20px; margin-left: 200px;">
                    <a style="cursor: pointer;" ng-click="openReportModal()">Alle tilbakemeldinger ({{reportedExercises.length}})</a>
                </div>
            </div>
        </div>
    </div>

</div>

<script type="text/ng-template" id="reportModal.html">
    <div class="modal-header">
        <h3>Tilbakemeldinger</h3>
    </div>
    <div class="modal-body" style="background-color: #F1F1F2" ng-click="closeActiveExercise()">
        <div ng-show="!exercise" class="container-fluid div-card" style="width: 960px;">
            <table class="table table-hover">
                <thead>
                    <tr>
                        <th style="width: 10%">Dato siste</th>
                        <th style="width: 20%">Sett</th>
                        <th style="width: 31%">Oppgave</th>
                        <th style="width: 15%">Antall tilbakemeldinger</th>
                        <th style="width: 4%"></th>
                    </tr>
                </thead>
                <tbody>
                    <tr ng-mouseenter="focused[$index] = true" ng-mouseleave="focused[$index] = false" ng-repeat="exercise in exercises | orderBy:'lastAdded':true track by $index">
                        <td ng-click="onChosenExercise(exercise.collectionId, exercise.exerciseId)" style="cursor: pointer">{{exercise.lastAdded}}</td>
                        <td ng-click="onChosenExercise(exercise.collectionId, exercise.exerciseId)" style="cursor: pointer">{{collections[exercise.collectionId].name}}</td>
                        <td ng-click="onChosenExercise(exercise.collectionId, exercise.exerciseId)" style="cursor: pointer">{{exercise.preview}}</td>
                        <td ng-click="onChosenExercise(exercise.collectionId, exercise.exerciseId)" style="cursor: pointer" align="center">{{exercise.reports.length}}</td>
                        <td align="center"><span ng-show="focused[$index]" class="glyphicon glyphicon-remove" ng-click="removeAllReports($index)" style="cursor: pointer"></span></td>
                    </tr>
                </tbody>

            </table>
        </div>
        <div ng-show="exercise" class="container-fluid">
            <span ng-click="goToOverview()" class="glyphicon glyphicon-chevron-left" align="left" style="cursor: pointer; margin-bottom: 20px">
                Alle tilbakemeldinger
            </span>
            <div class="container-fluid div-card" style="width: 960px; margin-bottom: 20px">
                <div class="row" style="margin-top: 20px; margin-bottom: 20px">
                    <div ng-repeat="reportArray in exerciseReportArrays track by $index">
                        <div class="col-xs-6">
                            <div ng-repeat="report in reportArray track by $index" class="container-fluid">
                                <p ng-show="!removeElements[$parent.$index*splitPoint + $index]"
                                   ng-click="removeElements[$parent.$index*splitPoint + $index]=true"
                                   style="cursor: pointer">
                                    {{report.date}}, {{report.message}}
                                </p>
                                <del ng-show="removeElements[$parent.$index*splitPoint + $index]"
                                     ng-click="removeElements[$parent.$index*splitPoint + $index]=false"
                                     style="cursor: pointer">
                                    <p>{{report.date}}, {{report.message}}</p>
                                </del>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="container-fluid div-card" ng-click="$event.stopPropagation(); activeExercise = 0" style="width: 960px;">
                <div class="container-fluid" style="margin-top: 30px"></div>
                <div onload="exerciseNumber = 0" ng-include="'collections/imageview.html'"></div>

                <div ng-if="exercise.type == 'pd'" ng-include="'collections/pd.html'"
                     onload="exerciseNumber = 0"></div>
                <div ng-if="exercise.type == 'mc'" ng-include="'collections/mc.html'"
                     onload="exerciseNumber = 0"></div>
                <div ng-if="exercise.type == 'tf'" ng-include="'collections/tf.html'"
                     onload="exerciseNumber = 0"></div>
                <div onload="exerciseNumber = 0" ng-include="'collections/extrapropertyview.html'"></div>
                <div class="container-fluid" style="margin-top: 30px"></div>
            </div>
        </div>
    </div>
    <div class="modal-footer">
        <button ng-show="exercise" type="button" class="btn btn-primary" ng-click="saveChanges()">Lagre</button>
        <button type="button" class="btn btn-default" ng-click="close()">Lukk</button>
    </div>
</script>